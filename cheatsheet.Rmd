o
```{r}
opts_chunk$set(warning=FALSE, message=FALSE)
```

# Loading ggplot

```{r}
library(ggplot2)
```

# Basic use with qplot

Load the sample data

```{r}
set.seed(1410)  # make the sample reproducible
head(diamonds)
dsmall <- diamonds[sample(nrow(diamonds), 100), ]
```

```{r}
qplot(carat, price, data=diamonds)
```

## Color, size, shape and other aesthetic attributes

```{r}
qplot(carat, price, data=dsmall, color=color, shape=cut, alpha=I(1/2))
```

## Plot geoms

```{r}
qplot(carat, price, data=dsmall, geom=c("point", "smooth"))
```

### Adding a smoother
There are many different smoother that can be used with `method` argument.

```{r}
qplot(carat, price, data=dsmall, geom=c("point", "smooth"), method="lm")
```

### Boxplots and jittered points

```{r}
qplot(color, price/carat, data=diamonds, geom="jitter")
```

```{r}
qplot(color, price/carat, data=diamonds, geom="boxplot")
```

### Histogram and density plots

```{r}
qplot(carat, data=diamonds, geom="histogram", fill=color)
```

```{r}
qplot(carat, data=diamonds, geom="density", color=color)
```

Change the amount of smoothing with `binwidth` argument.

```{r}
qplot(carat, data=diamonds, geom="histogram", binwidth=1)
qplot(carat, data=diamonds, geom="histogram", binwidth=0.1)
qplot(carat, data=diamonds, geom="histogram", binwidth=0.01)
```

### Bar charts

```{r}
qplot(color, data=diamonds, geom="bar")
```

```{r}
# bar plot of diamond color weighted by carat
qplot(color, data=diamonds, geom="bar", weight=carat) +
    scale_y_continuous("carat")
```

### Time series

```{r}
head(economics)
```

```{r}
qplot(date, unemploy/pop, data=economics, geom="line")
```

## Faceting

```{r}
qplot(carat, data=diamonds, facets=color~.,
      geom="histogram", binwidth=0.1, xlim=c(0,3))
```

## Other options
- `xlim` and `ylim`: set limits for x- and y-axis (e.g. `xlim=c(0,20)`)
- `main`: main title for the plot
- `xlab` and `ylab`: labels for x- and y-axis

```{r}
qplot(carat, price, data=dsmall,
      xlab="Price ($)",
      ylab="Weight (carats)",
      main="Price-weight relationship")
```

# Build a plot layer by layer

More complicated, multi-layer plots can be generated using `ggplot()`.

## Basic plot types

```{r}
df <- data.frame(x=c(3, 1, 5), y=c(2, 4, 6), label=c("a", "b", "c"))
p <- ggplot(df, aes(x, y, label=label)) + xlab(NULL) + ylab(NULL)
```

### `geom_point`
```{r}
p + geom_point() + ggtitle("geom_point")
```

### `geom_bar`
```{r}
p + geom_bar(stat="identity") + ggtitle("geom_bar(stat=\"identity\")")
```

### `geom_line`
```{r}
p + geom_line() + ggtitle("geom_line")
```

### `geom_area`
```{r}
p + geom_area() + ggtitle("geom_area")
```

### `geom_path`
```{r}
p + geom_path() + ggtitle("geom_path")
```

### `geom_text`
```{r}
p + geom_text() + ggtitle("geom_text")
```

### `geom_tile`
```{r}
p + geom_tile() + ggtitle("geom_tile")
```

### `geom_polygon`
```{r}
p + geom_polygon() + ggtitle("geom_polygon")
```

## Displaying distributions

For 1d data, the geom is the histogram.

### `geom_histogram` and `geom_freqpoly`

```{r}
depth_dist <- ggplot(diamonds, aes(depth)) + xlim(58, 68)
depth_dist + geom_histogram()
```

To compare the distribution between groups, couple of options

```{r}
depth_dist + geom_histogram(aes(y = ..density..), binwidth=0.1) +
    facet_grid(cut ~ .)
depth_dist + geom_histogram(aes(fill=cut), binwidth=0.1, position="fill")
depth_dist + geom_freqpoly(aes(y = ..density.., color=cut), binwidth=0.1)
```

### `geom_boxplot`

```{r}
qplot(cut, depth, data=diamonds, geom="boxplot")
library(plyr)
qplot(carat, depth, data=diamonds, geom="boxplot",
      group = round_any(carat, 0.1, floor), xlim=c(0, 3))
```

### `geom_jitter`

```{r}
qplot(class, cty, data=mpg, geom="jitter")
qplot(class, drv, data=mpg, geom="jitter")
```

### `geom_density`

```{r}
